-- BEFORE NORMALIZATION GIVEN INPUT
CREATE TABLE BEFORE_NORMALIZTION(USER_ID VARCHAR(20),U_EMAIL VARCHAR(50),F_NAME VARCHAR(30), L_NAME VARCHAR(30),CITY VARCHAR(20), STATE VARCHAR(20),ZIP NUMBER(20));

insert into BEFORE_NORMALIZTION(USER_ID,U_EMAIL,F_NAME,l_name,city,state,zip) VALUES ('MA12','ALEX@YMAIL.COM','ALEX','JONES','HOUSTON','TEXAS',75001);
insert into BEFORE_NORMALIZTION(USER_ID,U_EMAIL,F_NAME,l_name,city,state,zip) VALUES ('PO45','EMMA.JOHN@GMAIL.COM','EMMA','STONE','ALBANY','NEW YORK',10008);
insert into BEFORE_NORMALIZTION(USER_ID,U_EMAIL,F_NAME,l_name,city,state,zip) VALUES ('LA33','VICTORIA@YAHOO.CO','VICTORIA','AURORA','ISTANBUL','TURKEY',34000);
insert into BEFORE_NORMALIZTION(USER_ID,U_EMAIL,F_NAME,l_name,city,state,zip) VALUES ('CH99','JOE.1997@HOTMAIL.COM','JOE','JOHNSON','LOS ANGELES','CALIFORNIA',90201);
insert into BEFORE_NORMALIZTION(USER_ID,U_EMAIL,F_NAME,l_name,city,state,zip) VALUES ('DA74','DIANY@LIVE.COM','DANY','WILLIAM','MIAMI','FLORIDA',32006);

SELECT * FROM BEFORE_NORMALIZTION;


--AFTER NORMALIZATION

--1ST TABLE USER DETAILS
CREATE TABLE USER_DETAILS(USER_ID VARCHAR(20) primary KEY,U_EMAIL VARCHAR(50),zip NUMBER(20))

insert into USER_DETAILS(USER_ID,U_EMAIL,zip) VALUES ('MA12','ALEX@YMAIL.COM',75001);
insert into USER_DETAILS(USER_ID,U_EMAIL,zip) VALUES ('PO45','EMMA.JOHN@GMAIL.COM',10008);
insert into USER_DETAILS(USER_ID,U_EMAIL,zip) VALUES ('LA33','VICTORIA@YAHOO.CO',34000);
insert into USER_DETAILS(USER_ID,U_EMAIL,zip) VALUES ('CH99','JOE.1997@HOTMAIL.COM',90201);
insert into USER_DETAILS(USER_ID,U_EMAIL,zip) VALUES ('DA74','DIANY@LIVE.COM',32006);

SELECT * FROM USER_DETAILS;


--2ND TABLE USER NAME
CREATE TABLE USER_NAMES(USER_ID VARCHAR(20),F_NAME VARCHAR(30), L_NAME VARCHAR(30), FOREIGN KEY (USER_ID) REFERENCES USER_DETAILS(USER_ID));

insert into USER_NAMES(USER_ID,F_NAME,L_NAME) VALUES ('MA12','ALEX','JONES');
insert into USER_NAMES(USER_ID,F_NAME,L_NAME) VALUES ('PO45','EMMA','STONE');
insert into USER_NAMES(USER_ID,F_NAME,L_NAME) VALUES ('LA33','VICTORIA','AURORA');
insert into USER_NAMES(USER_ID,F_NAME,L_NAME) VALUES ('CH99','JOE','JOHNSON');
insert into USER_NAMES(USER_ID,F_NAME,L_NAME) VALUES ('DA74','DANY','WILLIAM');

SELECT * FROM USER_NAMES;


--3RD TABLE USER_ZIP TABLE
CREATE TABLE USER_ZIP(CITY VARCHAR(20), STATE VARCHAR(20),ZIP NUMBER(20));

insert into USER_ZIP(CITY , STATE ,ZIP ) VALUES ('HOUSTON','TEXAS',75001);
insert into USER_ZIP(CITY , STATE ,ZIP ) VALUES ('ALBANY','NEW YORK',10008);
insert into USER_ZIP(CITY , STATE ,ZIP ) VALUES ('ISTANBUL','TURKEY',34000);
insert into USER_ZIP(CITY , STATE ,ZIP ) VALUES ('LOS ANGELES','CALIFORNIA',90201);
insert into USER_ZIP(CITY , STATE ,ZIP ) VALUES ('MIAMI','FLORIDA',32006);

SELECT * FROM USER_ZIP;


--full table
 SELECT  *
    FROM USER_DETAILS
    INNER JOIN USER_NAMES ON user_names.user_id = user_details.user_id
    INNER JOIN USER_ZIP on USER_ZIP.zip = user_details.zip;

